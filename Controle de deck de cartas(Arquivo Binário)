#include<stdio.h>
#include<conio2.h>
#include<string.h>
#include<windows.h>

#define TF 100

struct TpJogo
{
	int CodJogo;
	char DescJogo[300], Status;
};
typedef struct TpJogo Jogos;

struct TpCarta
{
	int CodCarta, CodJogo, CodDeck;
	char DescCarta[300], NomeCarta[100], Status;
	
};typedef struct TpCarta Cartas;

struct TpDeck
{
	int CodDeck, Ano, CodJogo;
	char Titulo[300], Jogador[100], NomeJogo[300], Status;
	
};typedef struct TpDeck Decks;

struct TpDeckCarta
{
	int CodDeck, CodCarta;
	char Status;	
	
};typedef struct TpDeckCarta ControlDeckCarta;
void CadastroJogos(char Jogo[100]);
void CadastroCartas(char Carta[100], char Jogo[100]);
void CadastroDecks(char Deck[100], char Jogo[100]);
void CadastroCartaInDeck(char Jogo[100], char Deck[100], char Carta[100], char DeckCarta[100]);
void CadastroAutomaticoJogo(char Jogo[100]);
void CadastroAutomaticoCarta(char Carta[100]);
void CadastroAutomaticoDeck(char Deck[100]);
void CadastroAutomaticoDeckCarta(char DeckCarta[100]);
void ExibirJogos(char Jogo[100]);
void ExibirCartas(char Carta[100]);
void ExibirDecks(char Deck[100]);
void RelatorioDecks(char Deck[100], char DeckCarta[100], char Carta[100]);
void ExclusaoLogicaJogos(char Jogo[100], char Carta[100], char Deck[100], char DeckECarta[100]);
void ExclusaoLogicaCartas(char Jogo[100], char Carta[100], char DeckCarta[100]);
void ExclusaoLogicaDecks(char Jogo[100], char DeckCarta[100], char Deck[100]);
void ExclusaoLogicaDeckCarta(char DeckCarta[100]);
void ExcFisicaJogo(char Jogo[100]);
void ExcFisicaCarta(char Carta[100]);
void ExcFisicaDeck(char Deck[100]);
void ExcFisicaDeckCarta(char DeckCarta[100]);
void ExcLogicCartasJogo(FILE *PtrExcCarta, int CodJogo);
void ExcLogicDecksJogo(FILE *PtrExcDeck, int CodJogo);
void ExcRelacaoDeckCarta(FILE *PtrExDC, int VetDeck[TF], int Tam);
int BuscaExaustivaDC(FILE *PtrControlDC, int CodDeck, int CodCarta);
int BuscaBinariaCarta(FILE *PtrBuscaCarta, int Cod);
int BuscaSentinelaDeck(FILE *PtrBuscaD, int Cod);
int BuscaDC(FILE *PtrExDC, int CodDeck, int Vet[TF], int &TL);
int BuscaSequencialIndexadaJogo(FILE *PtrBuscaJogo, int Cod);
void BuscaDeckEmJogo(FILE *PtrBuscDeck, int Cod);
void BuscaCartaEmJogo(FILE *PtrBuscCarta, int Cod);
int BuscaCartaEmDeck(FILE *Ptrmarta, int Cod);
int VerificaControleC(FILE *PtrControlDC, int CodCarta);
int VerificaDeck(FILE *PtrDeck, int CodJogo, int pos);
int VerificaCarta(FILE *PtrCarta, int CodJogo, int pos);
void SelecaoDireta(char Jogo[100]);
void InsercaoDiretaCarta(char Carta[100]);
char Menu();
void MenuConio(int z);
void Executar(void);
void Inicio();
void AlteraDeckEmJogo(FILE *PtrBuscDeck, int Cod, char nome[300]);

void Carregando()
{
	system("cls");	
	gotoxy(33,15);
	Sleep(90);
	printf("Carregando..."); 
	gotoxy(48,15);
	for(INT i=0; i<10; i++)
	{
		
		Sleep(70);
    	printf(" ");
				
	}	
    printf("\n");
    system("cls");
}
void CadastroAutomaticoJogo(char Jogo[100])
{
	FILE *PtrCadJogo = fopen(Jogo, "ab");
	Jogos CadJogo;
	CadJogo.CodJogo = 1;
	strcpy(CadJogo.DescJogo, "Magic Duels");
	CadJogo.Status = 'A';
	fread(&CadJogo, sizeof(Jogos), 1, PtrCadJogo);
	fwrite(&CadJogo, sizeof(Jogos), 1, PtrCadJogo);
		
	CadJogo.CodJogo = 2;
	strcpy(CadJogo.DescJogo, "HearthStone");
	CadJogo.Status = 'A';
	fseek(PtrCadJogo, 0,2);
	fread(&CadJogo, sizeof(Jogos), 1, PtrCadJogo);	
	fwrite(&CadJogo, sizeof(Jogos), 1, PtrCadJogo);
	
	CadJogo.CodJogo = 3;
	strcpy(CadJogo.DescJogo, "Clash Royale");
	CadJogo.Status = 'A';
	fseek(PtrCadJogo, 0,2);
	fread(&CadJogo, sizeof(Jogos), 1, PtrCadJogo);
	fwrite(&CadJogo, sizeof(Jogos), 1, PtrCadJogo);
	
	CadJogo.CodJogo = 4;
	strcpy(CadJogo.DescJogo, "Pokemon TCG");
	CadJogo.Status = 'A';
	fseek(PtrCadJogo, 0,2);
	fread(&CadJogo, sizeof(Jogos), 1, PtrCadJogo);
	fwrite(&CadJogo, sizeof(Jogos), 1, PtrCadJogo);
	
	CadJogo.CodJogo = 12;
	strcpy(CadJogo.DescJogo, "Yu-Gi-Oh");
	CadJogo.Status = 'A';
	fseek(PtrCadJogo, 0,2);
	fread(&CadJogo, sizeof(Jogos), 1, PtrCadJogo);
	fwrite(&CadJogo, sizeof(Jogos), 1, PtrCadJogo);	
	
	fclose(PtrCadJogo);
}

void CadastroAutomaticoCarta(char Carta[100])
{
	FILE *PtrCadCarta = fopen(Carta, "ab");
	Cartas CadCarta;
	
	CadCarta.CodCarta = 10;
	strcpy(CadCarta.NomeCarta, "Garbodor");
	CadCarta.CodJogo = 12;
	CadCarta.Status = 'A';
	strcpy(CadCarta.DescCarta, "Se este pokemon tiver um card de ferramenta Pokemon anexado a ele, cada pokemon em jogo, na mao de cada jogador e na pilha de descarte de cada jogador nao tem Habilidades(exceto para   Garbotoxin)");
	fread(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	fwrite(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	
	CadCarta.CodCarta = 20;
	strcpy(CadCarta.NomeCarta, "Bone Splinters");
	CadCarta.CodJogo = 1;
	CadCarta.Status = 'A';
	strcpy(CadCarta.DescCarta, "Como custo adicional para lancar esta magia, sacrifique uma criatura.\nDestrua a criatura alvo.");
	fseek(PtrCadCarta, 0,2);
	fread(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	fwrite(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	
	CadCarta.CodCarta = 30;
	strcpy(CadCarta.NomeCarta, "Quaking Punch");
	CadCarta.CodJogo = 4;
	CadCarta.Status = 'A';
	strcpy(CadCarta.DescCarta, "Quando um Pokemon-EX eh nocauteado, seu oponente recebe 2 cards de premio.");
	fseek(PtrCadCarta, 0,2);
	fread(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	fwrite(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	
	CadCarta.CodCarta = 40;
	strcpy(CadCarta.NomeCarta, "Crescente Miracerta");
	CadCarta.CodJogo = 2;
	CadCarta.Status = 'A';
	strcpy(CadCarta.DescCarta,"Depois que seu heroi atacar um lacaio, seus lacios o atacam tambem.");
	fseek(PtrCadCarta, 0,2);
	fread(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	fwrite(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	
	CadCarta.CodCarta = 50;
	strcpy(CadCarta.NomeCarta, "Reave Soul");
	CadCarta.CodJogo = 1;
	CadCarta.Status = 'A';
	strcpy(CadCarta.DescCarta, "Destrua a criatura alvo com poder 3 ou menos.");
	fseek(PtrCadCarta, 0,2);
	fread(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	fwrite(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	
	CadCarta.CodCarta = 60;
	strcpy(CadCarta.NomeCarta, "Exercito de esqueletos");
	CadCarta.CodJogo = 3;
	CadCarta.Status = 'A';
	strcpy(CadCarta.DescCarta, "'Invoque um exercito de esqueletos. Conheca o Larry e seus amigos, Gerry, Terry, Maria e\t etc...'");
	fseek(PtrCadCarta, 0,2);
	fread(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	fwrite(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	
	CadCarta.CodCarta = 70;
	strcpy(CadCarta.NomeCarta, "Mistica Fragmentadora");
	CadCarta.CodJogo = 2;
	CadCarta.Status = 'A';
	strcpy(CadCarta.DescCarta, "Destrua um fragmento de alma do seu deck e cause 3 de dano a todos os outros lacaios.");
	fseek(PtrCadCarta, 0,2);
	fread(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	fwrite(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	
	CadCarta.CodCarta = 80;
	strcpy(CadCarta.NomeCarta, "Horda de servos");
	CadCarta.CodJogo = 3;
	CadCarta.Status = 'A';
	strcpy(CadCarta.DescCarta, "'Seis atacantes rapidos, sem aramadura. Tres eh demais, seis eh uma horda.'");
	fseek(PtrCadCarta, 0,2);
	fread(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	fwrite(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	
	CadCarta.CodCarta = 90;
	strcpy(CadCarta.NomeCarta, "Gravedigger");
	CadCarta.CodJogo = 2;
	CadCarta.Status = 'A';
	strcpy(CadCarta.DescCarta, "Quando o Coveiro entra em jogo, voce pode devolver o card de criatura alvo de seu cemiterio para sua mao.");
	fseek(PtrCadCarta, 0,2);
	fread(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
	fwrite(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
		
	fclose(PtrCadCarta);
}

void CadastroAutomaticoDeck(char Deck[100])
{
	FILE *PtrCadDeck = fopen(Deck, "ab+");
	Decks CadDeck;
	
	CadDeck.CodDeck = 123;
	strcpy(CadDeck.Titulo, "Enchantments");
	strcpy(CadDeck.Jogador, "HARBiNG3R");
	CadDeck.Ano = 2019;
	CadDeck.CodJogo = 1;
	strcpy(CadDeck.NomeJogo, "Magic Duels");
	CadDeck.Status = 'A';
	fread(&CadDeck, sizeof(Decks), 1, PtrCadDeck);
	fwrite(&CadDeck, sizeof(Decks), 1, PtrCadDeck);
	
	CadDeck.CodDeck = 456;
	strcpy(CadDeck.Titulo, "Inn-Vitational");
	strcpy(CadDeck.Jogador, "BattleTag");
	CadDeck.Ano = 2019;
	CadDeck.CodJogo = 2;
	strcpy(CadDeck.NomeJogo, "HearthStone");
	CadDeck.Status = 'A';
	fseek(PtrCadDeck, 0, 2);
	fread(&CadDeck, sizeof(Decks), 1, PtrCadDeck);
	fseek(PtrCadDeck, 0, 2);
	fwrite(&CadDeck, sizeof(Decks), 1, PtrCadDeck);
	
	CadDeck.CodDeck = 789;
	strcpy(CadDeck.Titulo, "Flakes Power");
	strcpy(CadDeck.Jogador, "Frank Oskam");
	CadDeck.Ano = 2020;
	CadDeck.CodJogo = 4;
	strcpy(CadDeck.NomeJogo, "Pokemon TCG");
	CadDeck.Status = 'A';
	fseek(PtrCadDeck, 0, 2);
	fread(&CadDeck, sizeof(Decks), 1, PtrCadDeck);
	fseek(PtrCadDeck, 0, 2);
	fwrite(&CadDeck, sizeof(Decks), 1, PtrCadDeck);
	
	fclose(PtrCadDeck);
}

void CadastroAutomaticoDeckCarta(char DeckCarta[100])
{
	FILE *PtrCadDC = fopen(DeckCarta, "ab");
	ControlDeckCarta CadDC;
	
	CadDC.CodDeck = 789;
	CadDC.CodCarta = 10;
	CadDC.Status = 'A';
	fread(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	fwrite(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	
	CadDC.CodDeck = 789;
	CadDC.CodCarta = 30;
	CadDC.Status = 'A';
	fseek(PtrCadDC, 0, 2);
	fread(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	fwrite(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	
	CadDC.CodDeck = 123;
	CadDC.CodCarta = 20;
	CadDC.Status = 'A';
	fseek(PtrCadDC, 0, 2);
	fread(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	fwrite(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	
	CadDC.CodDeck = 123;
	CadDC.CodCarta = 50;
	CadDC.Status = 'A';
	fseek(PtrCadDC, 0, 2);
	fread(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	fwrite(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	
	CadDC.CodDeck = 456;
	CadDC.CodCarta = 40;
	CadDC.Status = 'A';
	fseek(PtrCadDC, 0, 2);
	fread(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	fwrite(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	
	CadDC.CodDeck = 456;
	CadDC.CodCarta = 90;
	CadDC.Status = 'A';
	fseek(PtrCadDC, 0, 2);
	fread(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	fwrite(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	
	CadDC.CodDeck = 456;
	CadDC.CodCarta = 70;
	CadDC.Status = 'A';
	fseek(PtrCadDC, 0, 2);
	fread(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	fwrite(&CadDC, sizeof(ControlDeckCarta), 1, PtrCadDC);
	
	fclose(PtrCadDC);
}


void ExcFisicaDeck(char Deck[100])
{
	FILE *PtrExFisicDeck = fopen(Deck, "rb");
	FILE *PtrExTemp = fopen("Temp.dat", "wb");
	
	Decks ExcFisicDeck;
	fread(&ExcFisicDeck, sizeof(Decks), 1, PtrExFisicDeck);
	while(!feof(PtrExFisicDeck))
	{
		if(ExcFisicDeck.Status != 'I')
			fwrite(&ExcFisicDeck, sizeof(Decks), 1, PtrExTemp);
			
		fread(&ExcFisicDeck, sizeof(Decks), 1, PtrExFisicDeck);
	}
	fclose(PtrExFisicDeck);
	fclose(PtrExTemp);
	remove(Deck);
	rename("Temp.dat", Deck);
}

int BuscaSentinelaDeck(FILE *PtrBuscaD, int Cod)
{	
	int Qtde, i=0;
	Decks BuscaDeck;	
	fseek(PtrBuscaD, 0, 2);
	Qtde = ftell(PtrBuscaD) / sizeof(Decks);
	BuscaDeck.CodDeck = Cod;
	BuscaDeck.Status = 'A';
	fwrite(&BuscaDeck, sizeof(Decks), 1, PtrBuscaD);	
	rewind(PtrBuscaD);
	fread(&BuscaDeck, sizeof(Decks), 1, PtrBuscaD);
	while(!(Cod==BuscaDeck.CodDeck && BuscaDeck.Status == 'A'))
	{	
		fread(&BuscaDeck, sizeof(Decks), 1, PtrBuscaD);		
		i++;
	}	
	fseek(PtrBuscaD, Qtde * sizeof(Decks), 0);
	fread(&BuscaDeck, sizeof(Decks), 1, PtrBuscaD);
	BuscaDeck.Status = 'I';
	fseek(PtrBuscaD, Qtde * sizeof(Decks), 0);
	fwrite(&BuscaDeck, sizeof(Decks), 1, PtrBuscaD);			
	if(i<Qtde)	
		return i * sizeof(Decks);		
	else 
		return -1;	
}


int BuscaBinariaCarta(FILE *PtrBuscaC, int Cod)
{
	Cartas BuscaCarta;
	int i, m, f;
	i = 0;
	fseek(PtrBuscaC, 0, 2);
	f = ftell(PtrBuscaC)/sizeof(Cartas) - 1;
	m = f/2;
	
	fseek(PtrBuscaC, m * sizeof(Cartas), 0);
	fread(&BuscaCarta, sizeof(Cartas), 1, PtrBuscaC);	
	while(i<f && BuscaCarta.CodCarta != Cod)
	{
		if(Cod>BuscaCarta.CodCarta)
			i=m+1;
		else
			f=m-1;
		m = (i+f) / 2;
		fseek(PtrBuscaC, m * sizeof(Cartas), 0);
		fread(&BuscaCarta, sizeof(Cartas), 1, PtrBuscaC);		
	}
	if(BuscaCarta.CodCarta == Cod)		
		return m * sizeof(Cartas);	
	else
		return -1;
}

void SelecaoDireta(char Jogo[100])
{
	int Maior, Pos, Qtde, i=0;
	FILE *PtrSort = fopen(Jogo, "rb+");
	Jogos OrdJogos, OrdB;
	
	fseek(PtrSort, 0, 2);
	Qtde = ftell(PtrSort) / sizeof(Jogos);
	rewind(PtrSort);
	fread(&OrdJogos, sizeof(Jogos), 1, PtrSort);		
	while(Qtde > 1)
	{		
		Maior = OrdJogos.CodJogo;
		Pos = 0;		
		for(i=1; i<Qtde; i++)
		{			
			fseek(PtrSort, i*sizeof(Jogos), 0);			
			fread(&OrdB, sizeof(Jogos), 1, PtrSort);			
			if(Maior < OrdB.CodJogo)
			{
				Maior = OrdB.CodJogo;			
				Pos = i;
			}
		}	
		if(Pos < Qtde-1)
		{			
			fseek(PtrSort, (Qtde-1) * sizeof(Jogos), 0);
			fread(&OrdB, sizeof(Jogos), 1, PtrSort);
			
			fseek(PtrSort, Pos * sizeof(Jogos), 0);
			fread(&OrdJogos, sizeof(Jogos), 1, PtrSort);
			
			fseek(PtrSort, Pos * sizeof(Jogos), 0);
			fwrite(&OrdB, sizeof(Jogos), 1, PtrSort);
			
			fseek(PtrSort, (Qtde-1) * sizeof(Jogos), 0);
			fwrite(&OrdJogos, sizeof(Jogos), 1, PtrSort);																																				
		}
		Qtde--;
		rewind(PtrSort);
		fread(&OrdJogos, sizeof(Jogos), 1, PtrSort);				
	}	
	getch();
	fclose(PtrSort);		
}

void InsercaoDiretaCarta(char Carta[100])
{	
	FILE *PtrOrdCarta = fopen(Carta, "rb+");
	int Qtde;
	Cartas OrdCartaA, OrdCartaB;			
	fseek(PtrOrdCarta, 0, 2);
	Qtde = ftell(PtrOrdCarta) / sizeof(Cartas);
	
	fseek(PtrOrdCarta, (Qtde-1) * sizeof(Cartas), 0);
	fread(&OrdCartaA, sizeof(Cartas),1,PtrOrdCarta);
	
	fseek(PtrOrdCarta, (Qtde-2) * sizeof(Cartas), 0);
	fread(&OrdCartaB, sizeof(Cartas),1, PtrOrdCarta);
	
	while(Qtde > 1 && OrdCartaA.CodCarta < OrdCartaB.CodCarta)
	{		
		fseek(PtrOrdCarta, (Qtde-2) * sizeof(Cartas), 0);							
		fwrite(&OrdCartaA, sizeof(Cartas), 1, PtrOrdCarta);
		
		fseek(PtrOrdCarta, (Qtde-1) * sizeof(Cartas), 0);
		fwrite(&OrdCartaB, sizeof(Cartas), 1, PtrOrdCarta);								
		
		Qtde--;	
		
		fseek(PtrOrdCarta, (Qtde-2) * sizeof(Cartas), 0);
		fread(&OrdCartaB, sizeof(Cartas),1,PtrOrdCarta);
		
		fseek(PtrOrdCarta, (Qtde-1) * sizeof(Cartas), 0);
		fread(&OrdCartaA, sizeof(Cartas),1, PtrOrdCarta);
	}
}

void ExibirJogos(char Jogo[100])
{
	system("cls");
	int i=0, x=0;
	Jogos ExibeJogos;	
	FILE *PtrExibJogo = fopen(Jogo,"rb");
	fread(&ExibeJogos, sizeof(Jogos), 1, PtrExibJogo);	
	while(!feof(PtrExibJogo))
	{
		if(ExibeJogos.Status == 'A')
		{			
			gotoxy(25, 4);				
			printf("Codigo do jogo: %d Nome do jogo: %s", ExibeJogos.CodJogo, ExibeJogos.DescJogo);
			i++;
			getch();
		}
		fread(&ExibeJogos, sizeof(Jogos), 1, PtrExibJogo);		
		system("cls");
	}
	if(i==0)
	{
		system("cls");
		gotoxy(33,15);
		printf("Arquivo vazio!");	
		getch();
	}
	fclose(PtrExibJogo);	
}

void ExibirCartas(char Carta[100])
{
	system("cls");
	int i=0, x=0;
	Cartas ExibeCartas;	
	FILE *PtrExibCarta = fopen(Carta,"rb");
	fread(&ExibeCartas, sizeof(Cartas), 1, PtrExibCarta);
	while(!feof(PtrExibCarta))
	{
		if(ExibeCartas.Status == 'A')
		{	
			x = x + 1;
			gotoxy(29, 2);	
			printf("Codigo da carta: %d", ExibeCartas.CodCarta);
			gotoxy(28, 4);
			printf("Nome da carta: %s", ExibeCartas.NomeCarta);
			gotoxy(30, 6);
			printf("Descricao da carta");
			gotoxy(2, 8);
			printf("%s", ExibeCartas.DescCarta);
			i++;
			getch();
		}
		fread(&ExibeCartas, sizeof(Cartas), 1, PtrExibCarta);		
		system("cls");
	}
	if(i==0)
	{
		system("cls");
		gotoxy(33,15);
		printf("Arquivo vazio!");	
		getch();
	}		
	fclose(PtrExibCarta);	
}

void ExibirDecks(char Deck[100])
{
	system("cls");
	int i=0;
	Decks ExibeDecks;		
	FILE *PtrExibDeck = fopen(Deck,"rb");
	fread(&ExibeDecks, sizeof(Decks), 1, PtrExibDeck);
	while(!feof(PtrExibDeck))
	{
		if(ExibeDecks.Status == 'A')
		{		
			gotoxy(28, 2);	
			printf("Codigo do deck: %d", ExibeDecks.CodDeck);
			gotoxy(28, 4);
			printf("Nome do deck: %s", ExibeDecks.Titulo);
			gotoxy(28, 6);
			printf("Nome do jogo vinculado: %s", ExibeDecks.NomeJogo);
			gotoxy(28, 8);
			printf("Jogador responsavel: %s", ExibeDecks.Jogador);
			gotoxy(28, 10);
			printf("Ano de criacao: %d", ExibeDecks.Ano);
			i++;
			getch();
		}
		fread(&ExibeDecks, sizeof(Decks), 1, PtrExibDeck);	
		system("cls");
	}
	if(i==0)
	{
		system("cls");
		gotoxy(33,15);
		printf("Arquivo vazio!");	
		getch();
	}		
	fclose(PtrExibDeck);	
}

void BuscaDeckEmJogo(FILE *PtrBuscDeck, int Cod)
{	
	system("cls");
	int x = 5;
	MenuConio(0);
	Decks BuscDeck;
	rewind(PtrBuscDeck);
	fread(&BuscDeck, sizeof(Decks), 1, PtrBuscDeck);
	if(!feof(PtrBuscDeck))
	{
		gotoxy(20,3);
		printf("Decks");
	}
	while(!feof(PtrBuscDeck))
	{
		if(BuscDeck.CodJogo == Cod && BuscDeck.Status == 'A')
		{								
			gotoxy(20, x);
			printf("Codigo do deck: %d", BuscDeck.CodDeck);
			gotoxy(20, x+1);
			printf("Nome do Deck: %s", BuscDeck.Titulo);				
			x++;
		}
	
		fread(&BuscDeck, sizeof(Decks), 1, PtrBuscDeck);
	}
	getch();
}

void AlteraDeckEmJogo(FILE *PtrBuscDeck, int CodJogo, char nome[300])
{	
	Decks BuscDeck;
	int Vet[TF];
	int TL=0, i=0, j;
	rewind(PtrBuscDeck);
	fread(&BuscDeck, sizeof(Decks), 1, PtrBuscDeck);
	while(!feof(PtrBuscDeck))
	{		
		if(BuscDeck.CodJogo == CodJogo)
		{									
			Vet[i] = ftell(PtrBuscDeck) - sizeof(Decks);
			TL++;
			i++;						
		}
		fread(&BuscDeck, sizeof(Decks), 1, PtrBuscDeck);
	}
	i=0;
	while(i<TL)
	{		
		j = Vet[i];
		fseek(PtrBuscDeck, j * sizeof(Decks), 0);
		fread(&BuscDeck, sizeof(Decks), 1, PtrBuscDeck);
		strcpy(BuscDeck.NomeJogo, nome);
		fseek(PtrBuscDeck, j * sizeof(Decks), 0);
		fwrite(&BuscDeck, sizeof(Decks), 1, PtrBuscDeck);
		
		i++;
	}
	
}

void BuscaCartaEmJogo(FILE *PtrBuscCarta, int Cod)
{	
	system("cls");
	Cartas BuscCarta;
	MenuConio(0);
	int x=5;
	rewind(PtrBuscCarta);
	fread(&BuscCarta, sizeof(Cartas), 1, PtrBuscCarta);
	if(!feof(PtrBuscCarta))
	{	
		gotoxy(20,3);
		printf("Cartas");
	}
	while(!feof(PtrBuscCarta))
	{
		if(BuscCarta.CodJogo == Cod && BuscCarta.Status == 'A')
		{
			gotoxy(20,x);				
			printf("Codigo da Carta: %d", BuscCarta.CodCarta);				
			gotoxy(20,x+1);
			printf("Nome da carta: %s", BuscCarta.NomeCarta);
			printf("\n");			
			x = x + 2;
		}
		fread(&BuscCarta, sizeof(Cartas), 1, PtrBuscCarta);
	}
	getch();	
}

int BuscaExaustivaDC(FILE *PtrControlDC, int CodDeck, int CodCarta)
{
	ControlDeckCarta ControlDC;
	rewind(PtrControlDC);
	fread(&ControlDC, sizeof(ControlDeckCarta), 1, PtrControlDC);
	while(!feof(PtrControlDC))
	{
		if(ControlDC.CodDeck == CodDeck && ControlDC.CodCarta == CodCarta)
			return 1;		
		fread(&ControlDC, sizeof(ControlDeckCarta), 1, PtrControlDC);
	}
	if(!feof(PtrControlDC))
		return ftell(PtrControlDC) - sizeof(ControlDeckCarta);
	else
		return -1;	
}

int VerificaControleC(FILE *PtrControlDC, int CodCarta)
{
	ControlDeckCarta ControlDC;
	rewind(PtrControlDC);
	fread(&ControlDC, sizeof(ControlDeckCarta), 1, PtrControlDC);
	while(!feof(PtrControlDC) && ControlDC.CodCarta != CodCarta)	
		fread(&ControlDC, sizeof(ControlDeckCarta), 1, PtrControlDC);
	
	if(!feof(PtrControlDC))
		return ftell(PtrControlDC) - sizeof(ControlDeckCarta);
	else
		return -1;	
}

int VerificaDeck(FILE *PtrDeck, int CodJogo, int pos)
{
	Decks CadDeck;
	fseek(PtrDeck, pos, 0);
	fread(&CadDeck, sizeof(Decks), 1, PtrDeck);
	if(CadDeck.Status == 'I')
		return 1;
	if(CadDeck.CodJogo == CodJogo && CadDeck.Status == 'A')
		return 2;	
	if(CadDeck.CodJogo != CodJogo && CadDeck.Status == 'A')
		return 3;
	else
		return 0;
}

int VerificaCarta(FILE *PtrCarta, int CodJogo, int pos)
{
	Cartas CadCarta;
	Decks CadDeck;
	fseek(PtrCarta, pos, 0);
	fread(&CadCarta, sizeof(Cartas), 1, PtrCarta);
	if(CadCarta.Status == 'I')
		return 1;
	if(CadCarta.CodJogo == CodJogo && CadCarta.Status == 'A')
		return 2;
	if(CadCarta.CodJogo != CodJogo && CadCarta.Status == 'A')
		return 3;
}

void ExcLogicCartasJogo(FILE *PtrExcCarta, int CodJogo)
{
	Cartas ExcCarta;
	int Vet[TF], TL=0, i=0, Pos=0;
	rewind(PtrExcCarta);
	fread(&ExcCarta, sizeof(Cartas), 1, PtrExcCarta);
	while(!feof(PtrExcCarta))
	{
		if(ExcCarta.CodJogo == CodJogo)
		{		
			Vet[i] = ftell(PtrExcCarta) - sizeof(Cartas);
			TL++;
			i++;			
		}		
		fread(&ExcCarta, sizeof(Cartas), 1, PtrExcCarta);
	}
	i=0;
	while(i<TL)
	{
		Pos = Vet[i];
		ExcCarta.Status='I';
		fseek(PtrExcCarta, Pos, 0);
		fwrite(&ExcCarta, sizeof(Cartas), 1, PtrExcCarta);
		i++;
	}
}

int BuscaDC(FILE *PtrExDC, int CodDeck, int Vet[TF], int &TL)
{
	int i=0;	
	ControlDeckCarta CtrlDC;
	rewind(PtrExDC);
	fread(&CtrlDC, sizeof(ControlDeckCarta), 1, PtrExDC);
	while(!feof(PtrExDC))
	{		
		if(CtrlDC.CodDeck == CodDeck)
		{
			Vet[i] = ftell(PtrExDC) - sizeof(ControlDeckCarta);
			TL++;
			i++;		
		}		
		fread(&CtrlDC, sizeof(ControlDeckCarta), 1, PtrExDC);
	}
	if(TL>0)
		return 1;
	else
		return -1;
}

void ExcRelacaoDeckCarta(FILE *PtrExDC, int VetDeck[TF], int Tam)
{
	ControlDeckCarta ExCtrlDC;	
	int Pos=0, i=0, Vet[TF], TL=0, j=0, l=0;
	rewind(PtrExDC);	
	fread(&ExCtrlDC, sizeof(ControlDeckCarta), 1, PtrExDC);	
	while(!feof(PtrExDC))
	{
		
		for(l=0;l<Tam;l++)
		{		
			if(ExCtrlDC.CodDeck == VetDeck[l])
			{
				Vet[j] = ftell(PtrExDC) - sizeof(ControlDeckCarta);				
				j++;
				TL++;
										
			}
		}		
		fread(&ExCtrlDC, sizeof(ControlDeckCarta), 1, PtrExDC);	
	}
	j=0;
	while(j<TL)
	{	
		Pos = Vet[j];
		ExCtrlDC.Status = 'I';
		fseek(PtrExDC, Pos, 0);
		fwrite(&ExCtrlDC, sizeof(ControlDeckCarta), 1, PtrExDC);
		j++;
	}	
}

void ExcLogicDecksJogo(FILE *PtrExcDeck, FILE *PtrExDC, int CodJogo)
{
	Decks ExcDeck;
	int Vet[TF], TL=0, i=0, Pos=0, VetDeck[TF];
	rewind(PtrExcDeck);	
	fread(&ExcDeck, sizeof(Decks), 1, PtrExcDeck);	
	while(!feof(PtrExcDeck))
	{
		if(ExcDeck.CodJogo == CodJogo)
		{
			VetDeck[i] = ExcDeck.CodDeck;
			Vet[i] = ftell(PtrExcDeck) - sizeof(Decks);
			TL++;
			i++;
		}
		fread(&ExcDeck, sizeof(Decks), 1, PtrExcDeck);
	}
	i=0;
	while(i<TL)
	{	
		Pos = Vet[i];
		ExcDeck.Status = 'I';			
		fseek(PtrExcDeck, Pos, 0);				
		fwrite(&ExcDeck, sizeof(Decks), 1, PtrExcDeck);
		i++;
	}	
	ExcRelacaoDeckCarta(PtrExDC, VetDeck, TL);
}


void BuscaCartaEmDeck(char DeckCarta[100], char Carta[100], int Cod)
{
	int i=0, VetCarta[TF], TL=0, cont=0;
	FILE *PtrRelDC = fopen(DeckCarta, "rb");
	FILE *PtrRelCarta = fopen(Carta, "rb");
	ControlDeckCarta RelDC;
	Cartas RelCarta;	
	fread(&RelDC, sizeof(ControlDeckCarta), 1, PtrRelDC);
	while(!feof(PtrRelDC))
	{
		if(RelDC.CodDeck == Cod && RelDC.Status == 'A')
		{		
			VetCarta[i] = RelDC.CodCarta;					
			i++;
			TL++;					
		}
		fread(&RelDC, sizeof(ControlDeckCarta), 1, PtrRelDC);
	}
	i=0;	
	fread(&RelCarta, sizeof(Cartas), 1, PtrRelCarta);
	while(i<TL)
	{
		rewind(PtrRelCarta);
		fread(&RelCarta, sizeof(Cartas), 1, PtrRelCarta);	
		while(!feof(PtrRelCarta))
		{					
			if(RelCarta.CodCarta == VetCarta[i] && RelCarta.Status == 'A')
				printf("   - %s\n", RelCarta.NomeCarta);
				
			fread(&RelCarta, sizeof(Cartas), 1, PtrRelCarta);						
		}
		i++;
	}
	if(TL==0)
		printf("\nEsse deck nao possui cartas vinculadas!\n");
	else
		printf("\n\nQuantidade de cartas vinculadas a esse deck: %d", TL);
		
	fclose(PtrRelDC);
	fclose(PtrRelCarta);
}

int BuscaSequencialIndexadaJogo(FILE *PtrBuscJogo, int Elem)
{
	int i=0, Qtde;
	Jogos BuscJogo;
	fseek(PtrBuscJogo, 0, 2);
	Qtde = ftell(PtrBuscJogo) / sizeof(Jogos);
	rewind(PtrBuscJogo);
	fread(&BuscJogo, sizeof(Jogos), 1, PtrBuscJogo);
	while(!feof(PtrBuscJogo) && Elem > BuscJogo.CodJogo)
	{	
		fread(&BuscJogo, sizeof(Jogos), 1, PtrBuscJogo);
		i++;
	}
	if(i<Qtde && Elem == BuscJogo.CodJogo && BuscJogo.Status == 'A')	
		return i * sizeof(Jogos);
	
	else 
		return -1;	
}

void RelatorioDecks(char Deck[100], char DeckCarta[100], char Carta[100])
{
	system("cls");
	FILE *PtrRelDeck = fopen(Deck, "rb+");	
	int pos;	
	Decks RelDeck;		
	fread(&RelDeck, sizeof(Decks), 1, PtrRelDeck);
	if(!feof(PtrRelDeck))
	{		
		printf("\nDigite o codigo do deck: ");
		scanf("%d", &RelDeck.CodDeck);				
		if(RelDeck.CodDeck == -1)
			printf("");
		else
		{	
			if(BuscaSentinelaDeck(PtrRelDeck, RelDeck.CodDeck) == -1)
				printf("\nDeck Inexistente!\n");
			else
			{			
									
				if(BuscaSentinelaDeck(PtrRelDeck, RelDeck.CodDeck) != -1)	
				{
					system("cls");
					pos = BuscaSentinelaDeck(PtrRelDeck, RelDeck.CodDeck);
					fseek(PtrRelDeck, pos, 0);
					fread(&RelDeck, sizeof(Decks), 1, PtrRelDeck);
					printf("--> Deck: %s\n\nJogo: %s - (%d) - Jogador responsavel: %s\n\n", RelDeck.Titulo, RelDeck.NomeJogo, RelDeck.Ano, RelDeck.Jogador);			
					BuscaCartaEmDeck(DeckCarta, Carta, RelDeck.CodDeck);			
				}
				else
					printf("\nDeck Inexistente!\n");			
			}
		}
		
	}
	else
	{
		system("cls");	
		printf("\nArquivo Vazio!\n");
	}
	getch();
	fclose(PtrRelDeck);	
}

void CadastroJogos(char Jogo[100])
{
	system("cls");
	int Codigo;		
	FILE *PtrCadJogo;
	Jogos CadJogo;
	MenuConio(0);
	gotoxy(27,3);
	printf("####CADASTRO DE JOGOS####");
	gotoxy(24,5);	
	printf("Digite o Codigo do Jogo(-1 - SAIR): ");
	scanf("%d", &CadJogo.CodJogo);
	while(CadJogo.CodJogo != -1)
	{	
		PtrCadJogo = fopen(Jogo, "ab+");			
		if(BuscaSequencialIndexadaJogo(PtrCadJogo, CadJogo.CodJogo) == -1 && CadJogo.CodJogo > 0)
		{
			gotoxy(24,7);
			printf("Digite o nome do Jogo: ");
			fflush(stdin);
			gets(CadJogo.DescJogo);
			CadJogo.Status = 'A';
			fseek(PtrCadJogo, 0, 2);
			fwrite(&CadJogo, sizeof(Jogos), 1, PtrCadJogo);
			Carregando();
			gotoxy(33,15);	
			printf("JOGO CADASTRADO!");
			fclose(PtrCadJogo);
			SelecaoDireta("Jogos.dat");					
		}
		else
		{		
			system("cls");			
			if(CadJogo.CodJogo == 0)
			{		
				gotoxy(27,10);		
				printf("O Codigo do jogo deve ser maior que zero!");						
			}
			else
			{
				gotoxy(27, 10);				
				printf("O jogo com codigo %d ja existe!", CadJogo.CodJogo);					
			}
		}
		getch();
		fflush(stdin);
		system("cls");
		MenuConio(0);
		gotoxy(27,3);
		printf("####CADASTRO DE JOGOS####");
		gotoxy(24,5);	
		printf("Digite o Codigo do Jogo(-1 - SAIR): ");
		scanf("%d", &CadJogo.CodJogo);		
	}	
	fclose(PtrCadJogo);
	
	
}
void CadastroCartas(char Carta[100], char Jogo[100])
{
	system("cls");
	FILE *PtrCadCarta;
	FILE *PtrCadJogo = fopen(Jogo, "rb");
	Cartas CadCarta;
	Jogos CadJogo;
	MenuConio(0);
	gotoxy(26,3);	
	printf("####CADASTRO DE CARTAS####");
	gotoxy(16,5);
	printf("Digite o codigo de um jogo existente(-1 - SAIR): ");
	scanf("%d", &CadJogo.CodJogo);
	while(CadJogo.CodJogo != -1)
	{
		if(CadJogo.CodJogo == 0)
		{
			clrscr();
			gotoxy(27,10);
			printf("O codigo do jogo deve ser maior que zero!");
			getch();
		}
		else		
			if(BuscaSequencialIndexadaJogo(PtrCadJogo, CadJogo.CodJogo) == -1)
			{
				clrscr();
				gotoxy(27,10);
				printf("O jogo com codigo %d nao existe!", CadJogo.CodJogo);		
				getch();
			}
		else
		{
			gotoxy(16,7);
			printf("Digite o codigo da carta(-1 - SAIR): ");				
			scanf("%d", &CadCarta.CodCarta);
			
			while(CadCarta.CodCarta != -1)
			{		
				PtrCadCarta = fopen(Carta, "ab+");			
				if(BuscaBinariaCarta(PtrCadCarta, CadCarta.CodCarta) == -1 && CadCarta.CodCarta > 0)
				{
					CadCarta.CodJogo = CadJogo.CodJogo;
					CadCarta.CodDeck = 0;
					gotoxy(16,9);
					printf("Digite o nome da carta: ");
					fflush(stdin);
					gets(CadCarta.NomeCarta);
					fflush(stdin);
					gotoxy(16,11);
					printf("Descricao: ");
					gets(CadCarta.DescCarta);
					CadCarta.Status = 'A';
					fseek(PtrCadCarta, 0, 2);
					fwrite(&CadCarta, sizeof(Cartas),1,PtrCadCarta);
					Carregando();
					gotoxy(33,15);
					printf("CARTA CADASTRADA!");
					getch();
					fclose(PtrCadCarta);
					InsercaoDiretaCarta(Carta);
				}
				else
					if(CadCarta.CodCarta == 0)
					{
						system("cls");
						gotoxy(27,15);
						printf("O codigo da carta deve ser maior que zero!\n");
						getch();
					}
					else
						if(BuscaBinariaCarta(PtrCadCarta, CadCarta.CodCarta) != -1)
						{
							system("cls");
							gotoxy(27,15);							
							printf("A carta com codigo %d ja existe!\n", CadCarta.CodCarta);							
							getch();
						}										
				clrscr();
				MenuConio(0);
				gotoxy(16,7);
				printf("Digite o codigo da carta(-1 - SAIR): ");					
				scanf("%d", &CadCarta.CodCarta);					
			}
		}		
		system("cls");
		MenuConio(0);
		gotoxy(26,3);	
		printf("####CADASTRO DE CARTAS####");
		gotoxy(16,5);
		printf("Digite o codigo de um jogo existente(-1 - SAIR): ");
		scanf("%d", &CadJogo.CodJogo);
	}
		
		
	fclose(PtrCadJogo);
	fclose(PtrCadCarta);		
}
		

void CadastroDecks(char Deck[100], char Jogo[100])
{
	system("cls");
	int pos;
	FILE *PtrCadDeck = fopen(Deck, "rb+");
	FILE *PtrCadJogo = fopen(Jogo, "rb");
	Decks CadDeck;
	Jogos CadJogo;
	MenuConio(0);
	gotoxy(26,3);
	printf("####CADASTRO DE DECKS####");
	gotoxy(20,5);
	printf("Digite o codigo do jogo(-1 - SAIR): ");
	scanf("%d", &CadJogo.CodJogo);
	while(CadJogo.CodJogo != -1)
	{
		if(CadJogo.CodJogo == 0)
		{		
			system("cls");
			gotoxy(27,15);
			printf("O codigo do jogo deve ser maior que zero!\n");
			getch();		
		}
		else
		{
			if(BuscaSequencialIndexadaJogo(PtrCadJogo, CadJogo.CodJogo) == -1)
			{
				system("cls");
				gotoxy(27,15);
				printf("O jogo com codigo %d nao existe!", CadJogo.CodJogo);
				getch();
			}
			else
			{
				gotoxy(20,7);				
				printf("Digite o codigo do deck(-1 - SAIR): ");
				scanf("%d", &CadDeck.CodDeck);
				while(CadDeck.CodDeck != -1)
				{
					if(CadDeck.CodDeck == 0)
					{
						system("cls");
						gotoxy(27,15);
						printf("O codigo do deck deve ser maior que zero!");
						getch();
					}
					else
						if(BuscaSentinelaDeck(PtrCadDeck, CadDeck.CodDeck) == -1)
						{
							pos = BuscaSequencialIndexadaJogo(PtrCadJogo, CadJogo.CodJogo);													
							fseek(PtrCadJogo, pos, 0);							
							fread(&CadJogo, sizeof(Jogos),1,PtrCadJogo);
							strcpy(CadDeck.NomeJogo, CadJogo.DescJogo);
							gotoxy(20,9);
							printf("Digite o nome do deck: ");
							fflush(stdin);
							gets(CadDeck.Titulo);
							gotoxy(20,11);
							printf("Jogador Responsavel: ");
							fflush(stdin);
							gets(CadDeck.Jogador);
							gotoxy(20,13);
							printf("Ano de criacao: ");
							fflush(stdin);
							scanf("%d", &CadDeck.Ano);
							CadDeck.Status = 'A';
							CadDeck.CodJogo = CadJogo.CodJogo;
							fseek(PtrCadDeck, 0, 2);														
							fwrite(&CadDeck, sizeof(Decks), 1, PtrCadDeck);
							Carregando();
							gotoxy(33,15);
							printf("DECK CADASTRADO!");	
							getch();												
						}
						else
							if(BuscaSentinelaDeck(PtrCadDeck, CadDeck.CodDeck) != -1)
							{
								system("cls");
								gotoxy(27,15);
								printf("O deck com codigo %d ja existe!", CadDeck.CodDeck);
								getch();							
							}
					system("cls");
					MenuConio(0);
					gotoxy(20,6);
					printf("Digite o codigo do deck(-1 - SAIR): ");
					scanf("%d", &CadDeck.CodDeck);				
				}				
			}
		}
		system("cls");
		MenuConio(0);
		gotoxy(26,3);
		printf("####CADASTRO DE DECKS####");
		gotoxy(20,5);
		printf("Digite o codigo do jogo(-1 - SAIR): ");
		scanf("%d", &CadJogo.CodJogo);
	}	
	fclose(PtrCadDeck);
	fclose(PtrCadJogo);
}

void CadastroCartaInDeck(char Jogo[100], char Deck[100], char Carta[100], char DeckCarta[100])
{
	system("cls");
	int pos, x;
	FILE *PtrJogo = fopen(Jogo, "rb");	
	FILE *PtrControlDC = fopen(DeckCarta, "ab+");
	FILE *PtrCarta = fopen(Carta, "rb+");
	FILE *PtrDeck = fopen(Deck, "rb+");
	Jogos CadJogo;
	Decks CadDeck;
	Cartas CadCarta;
	ControlDeckCarta ControlDC;
	MenuConio(0);
	gotoxy(26,3);	
	printf("####CADASTRO DE CARTAS EM DECKS####");
	gotoxy(20,5);
	printf("Digite o codigo do jogo(-1 - SAIR): ");
	scanf("%d", &CadJogo.CodJogo);
	while(CadJogo.CodJogo != -1)
	{
		if(CadJogo.CodJogo == 0)
		{
			system("cls");
			gotoxy(27,15);
			printf("O codigo do jogo deve ser maior que zero!");
			getch();
		}
		if(BuscaSequencialIndexadaJogo(PtrJogo, CadJogo.CodJogo) != -1)
		{
			gotoxy(20,7);
			printf("Digite o codigo do deck: ");
			scanf("%d", &CadDeck.CodDeck);
			while(CadDeck.CodDeck != -1)
			{
				if(CadDeck.CodDeck == 0)
				{
					system("cls");
					gotoxy(27,15);	
					printf("O codigo do deck deve ser maior que zero!");
					getch();
				}
				else
				{
					if(BuscaSentinelaDeck(PtrDeck, CadDeck.CodDeck) != -1)
					{			
						pos = BuscaSentinelaDeck(PtrDeck, CadDeck.CodDeck);		
						if(VerificaDeck(PtrDeck, CadJogo.CodJogo, pos) == 2)
						{
							gotoxy(20,9);
							printf("Digite o codigo da carta(-1 - SAIR): ");
							scanf("%d", &CadCarta.CodCarta);
							while(CadCarta.CodCarta != -1)
							{
								if(CadCarta.CodCarta == 0)
								{
									system("cls");
									gotoxy(27,13);
									printf("O codigo da carta deve ser maior que zero!");
								}
								else
								{								
									
									if(BuscaBinariaCarta(PtrCarta, CadCarta.CodCarta) != -1)
									{
										pos = BuscaBinariaCarta(PtrCarta, CadCarta.CodCarta);
										
										if(VerificaCarta(PtrCarta, CadJogo.CodJogo, pos) == 2)
										{
											if(BuscaExaustivaDC(PtrControlDC, CadDeck.CodDeck, CadCarta.CodCarta) == -1)
											{																					
												fseek(PtrCarta, pos, 0);
												fread(&CadCarta, sizeof(Cartas), 1, PtrCarta);
												gotoxy(20,11);
												printf("Codigo da Carta: %d",CadCarta.CodCarta);
												gotoxy(20,12);
												printf("Nome da carta: %s", CadCarta.NomeCarta);
												gotoxy(20,14);
												printf("Deseja cadastra-la no deck %d? - (S/N)", CadDeck.CodDeck);
												if(toupper(getch()) == 'S')
												{
													ControlDC.CodDeck = CadDeck.CodDeck;
													ControlDC.CodCarta = CadCarta.CodCarta;
													ControlDC.Status = 'A';	
													fseek(PtrControlDC, 0, 2);											
													fwrite(&ControlDC, sizeof(ControlDeckCarta), 1, PtrControlDC);
													Carregando();
													gotoxy(33,15);
													printf("CARTA CADASTRADA NO DECK!");
													getch();									
												}
											}
											else
												if(BuscaExaustivaDC(PtrControlDC, CadDeck.CodDeck, CadCarta.CodCarta) == 1)
												{
													system("cls");
													gotoxy(20,11);
													printf("A carta ja esta cadastrada nesse deck!");
													getch();
												}
										}		
										else
										{									
											if(VerificaCarta(PtrCarta, CadJogo.CodJogo, pos) == 3)
											{
												system("cls");
												gotoxy(20,11);
												printf("Essa carta pertence a outro jogo!");
												getch();
											}
											else
											{											
												if(VerificaCarta(PtrCarta, CadJogo.CodJogo, pos) == 1)
												{
													system("cls");
													gotoxy(20,11);
													printf("Carta Inexistente!");
													getch();
												}
												else
												{
													system("cls");
													gotoxy(20,11);
													printf("Carta Vinculada a outro deck!");
													getch();										
												}
											}
										}
										
									}
									else
									{
										system("cls");
										gotoxy(20,11);
										printf("Carta Inexistente!");
										getch();
									}
									
								}
								
								gotoxy(20,11);
								printf("Digite o codigo da carta(-1 - SAIR): ");
								scanf("%d", &CadCarta.CodCarta);							
							}
						}
						else
						{						
							if(VerificaDeck(PtrDeck, CadJogo.CodJogo, pos) == 3)
							{
								system("cls");
								gotoxy(20,9);
								printf("Esse deck pertence a outro jogo!");
								getch();
							}
							else
							{
								system("cls");
								gotoxy(20,9);
								printf("Deck Inexistente!");
								getch();
							}
						}
						
					}
					else
					{
						system("cls");
						gotoxy(20,9);
						printf("Deck Inexistente!");
						getch();
					}
				}
				gotoxy(20,9);
				printf("Digite o codigo do deck(-1 - SAIR): ");
				scanf("%d", &CadDeck.CodDeck);
				
			}
		}
		else
			if(BuscaSequencialIndexadaJogo(PtrJogo, CadJogo.CodJogo) == -1 && CadJogo.CodJogo > 0)
			{
				system("cls");
				gotoxy(20,7);
				printf("Jogo Inexistente!");
				getch();
			}
		
		system("cls");
		MenuConio(0);
		gotoxy(26,3);
		printf("####CADASTRO DE CARTAS EM DECKS####");
		gotoxy(20,5);
		printf("Digite o codigo do jogo(-1 - SAIR): ");
		scanf("%d", &CadJogo.CodJogo);	
	}
	fclose(PtrJogo);
	fclose(PtrDeck);
	fclose(PtrCarta);
	fclose(PtrControlDC);
}
//interface de cima feita!
void ExclusaoLogicaJogos(char Jogo[100], char Carta[100], char Deck[100], char DeckECarta[100]) 
{
	system("cls");
	FILE *PtrExJogo = fopen(Jogo, "rb+");
	FILE *PtrExCarta = fopen(Carta, "rb+");
	FILE *PtrExDeck = fopen(Deck, "rb+");
	FILE *PtrExDC = fopen(DeckECarta, "rb+");
	int PosJogo, VetDeck[TF];	
	Jogos ExJogo;
	MenuConio(0);
	gotoxy(26,3);
	printf("###EXCLUSAO DE JOGO###");
	gotoxy(20,5);
	printf("Digite o codigo do jogo(-1 - SAIR): ");
	scanf("%d", &ExJogo.CodJogo);	
	while(ExJogo.CodJogo != -1)
	{		
		if(ExJogo.CodJogo == 0)
		{
			system("cls");
			gotoxy(20, 15);
	    	printf("O codigo do jogo deve ser maior que zero!");
	    	getch();
	    }
		else
		{			
			if(BuscaSequencialIndexadaJogo(PtrExJogo, ExJogo.CodJogo)!= -1)
			{		
				PosJogo = BuscaSequencialIndexadaJogo(PtrExJogo, ExJogo.CodJogo);
				fseek(PtrExJogo, PosJogo, 0);
				fread(&ExJogo, sizeof(Jogos), 1, PtrExJogo);
				gotoxy(20,7);		
				printf("Codigo do Jogo: %d",ExJogo.CodJogo);
				gotoxy(20,8);
				printf("Nome do Jogo: %s", ExJogo.DescJogo);
				getch();
				BuscaCartaEmJogo(PtrExCarta, ExJogo.CodJogo);
				BuscaDeckEmJogo(PtrExDeck, ExJogo.CodJogo); 
				gotoxy(20,20);
				printf("Deseja excluir esse jogo? - (S/N): ");
				if(toupper(getch()) == 'S')
				{						
					ExcLogicCartasJogo(PtrExCarta, ExJogo.CodJogo);
					ExcLogicDecksJogo(PtrExDeck, PtrExDC, ExJogo.CodJogo);					
					
					ExJogo.Status = 'I';					
					fseek(PtrExJogo, PosJogo, 0);			
					fwrite(&ExJogo, sizeof(Jogos), 1, PtrExJogo);
					Carregando();
					gotoxy(33,15);								  		
			  		printf("JOGO EXCLUIDO!");			  		
			  		getch();
			    }
		    }			
		    else
		    {
		    	system("cls");
				gotoxy(20,15);		    
				printf("O Jogo com codigo %d nao existe!", ExJogo.CodJogo);
				getch();
			}
			
		}
		system("cls");
		MenuConio(0);
		gotoxy(26,3);
		printf("###EXCLUSAO DE JOGO###");
		gotoxy(20,5);
		printf("Digite o codigo do jogo(-1 - SAIR): ");
		scanf("%d", &ExJogo.CodJogo);			
	
	}	
	
	fclose(PtrExJogo);
	fclose(PtrExCarta);
	fclose(PtrExDeck);
	fclose(PtrExDC);
}

void ExclusaoLogicaDecks(char Jogo[100], char DeckCarta[100], char Deck[100])
{
	system("cls");
	int PosDeck, Cod, Vet[TF], TL=0, Pos=0, i=0;
	FILE *PtrExDeck = fopen (Deck, "rb+");
	FILE *PtrExJogo = fopen(Jogo, "rb");
	FILE *PtrExDC = fopen(DeckCarta, "rb+");
	Decks ExDeck;
	Jogos ExJogo;
	ControlDeckCarta ExCtrlDC;
	MenuConio(0);
	gotoxy(26,3);
	printf("###EXCLUSAO DE DECKS###");
	gotoxy(20,5);
	printf("Digite o Codigo do Jogo: ");
	scanf("%d",&ExJogo.CodJogo);
	while(ExJogo.CodJogo != -1)
	{		
		if(BuscaSequencialIndexadaJogo(PtrExJogo, ExJogo.CodJogo) != -1)
		{
			gotoxy(20,7);
			printf("Digite o Codigo do Deck: ");
			scanf("%d",&ExDeck.CodDeck);
						
			if(BuscaSentinelaDeck(PtrExDeck, ExDeck.CodDeck) != -1)
			{
				Pos = BuscaSentinelaDeck(PtrExDeck, ExDeck.CodDeck);
				if(VerificaDeck(PtrExDeck, ExJogo.CodJogo, Pos) == 2)
				{
					Cod = ExDeck.CodDeck;				
					PosDeck = BuscaSentinelaDeck(PtrExDeck, ExDeck.CodDeck);
					fseek(PtrExDeck, PosDeck, 0);
					fread(&ExDeck, sizeof(Decks), 1, PtrExDeck);
					gotoxy(20,9);
					printf("Codigo do deck: %d", ExDeck.CodDeck);
					gotoxy(20,10);
					printf("Nome do deck: %s", ExDeck.Titulo);
					gotoxy(20,12);
					printf("Deseja excluir esse deck? - (S/N): ");
					if(toupper(getch()) == 'S')
					{
						BuscaDC(PtrExDC, Cod, Vet, TL);
											
						while(i<TL)
						{						
							Pos = Vet[i];						
							ExCtrlDC.Status = 'I';
							fseek(PtrExDC, Pos, 0);
							fwrite(&ExCtrlDC, sizeof(ControlDeckCarta), 1, PtrExDC);						
							i++;
						}							
					
						ExDeck.Status='I';
						fseek(PtrExDeck ,PosDeck, 0);
						fwrite(&ExDeck, sizeof(Decks), 1, PtrExDeck);
						Carregando();
						gotoxy(33,15);				
						printf("DECK EXCLUIDO!");
						getch();
					}
				}
				else
				{
					if(VerificaDeck(PtrExDeck, ExJogo.CodJogo, Pos) == 3)
					{
						system("cls");
						gotoxy(27,15);
						printf("Este Deck pertence a outro jogo!");
						getch();
					}
					else
					{	
						system("cls");
						gotoxy(33,15);
						printf("Deck Inexistente!");
						getch();
					}
				}
				
			}
			else 
			{
				system("cls");
				gotoxy(33,15);
				printf("Deck Inexistente!");
				getch();
			}
		}
		else
		{
			system("cls");
			gotoxy(33,15);
			printf("Jogo Inexistente!");
			getch();
		}
		system("cls");
		MenuConio(0);
		gotoxy(26,3);
		printf("###EXCLUSAO DE DECKS###");
		gotoxy(20,5);
		printf("Digite o Codigo do Jogo: ");
		scanf("%d",&ExJogo.CodJogo);	
	}
	fclose(PtrExDeck);
	fclose(PtrExJogo);
	fclose(PtrExDC);
}


void ExclusaoLogicaCartas(char Jogo[100], char Carta[100], char DeckCarta[100]) 
{
	system("cls");
	int PosCarta;
	FILE *PtrExCarta = fopen(Carta,"rb+");
	FILE *PtrExJogo = fopen(Jogo, "rb");
	FILE *PtrDC = fopen(DeckCarta, "rb");
	Cartas ExCarta;
	Jogos ExJogo;
	MenuConio(0);
	gotoxy(26,3);
	printf("###EXCLUSAO DE CARTAS###");
	gotoxy(20,5);
	printf("Digite o codigo do jogo: ");
	scanf("%d",&ExJogo.CodJogo);
	while(ExJogo.CodJogo != -1)
	{
		if(BuscaSequencialIndexadaJogo(PtrExJogo, ExJogo.CodJogo) != -1)
		{
			gotoxy(20,7);
			printf("Digite o codigo da carta: ");
			scanf("%d",&ExCarta.CodCarta);			
			if(BuscaBinariaCarta(PtrExCarta,ExCarta.CodCarta) != -1)
			{
				PosCarta = BuscaBinariaCarta(PtrExCarta, ExCarta.CodCarta);				
				if(VerificaCarta(PtrExCarta, ExJogo.CodJogo, PosCarta) == 2)
				{									
					if(VerificaControleC(PtrDC, ExCarta.CodCarta) == -1)
					{				
						PosCarta = BuscaBinariaCarta(PtrExCarta,ExCarta.CodCarta);
						fseek(PtrExCarta,PosCarta,0);
						fread(&ExCarta,sizeof(Cartas),1,PtrExCarta);
						gotoxy(20,9);
						printf("Codigo da carta: %d",ExCarta.CodCarta);
						gotoxy(20,10);
						printf("Nome da Carta: %s",ExCarta.NomeCarta);
						gotoxy(20,11);
						printf("Descricao: %s", ExCarta.DescCarta);
						gotoxy(20,13);
						printf("Deseja excluir essa carta? - (S/N): ");
						if(toupper(getch()) == 'S')
						{						
							ExCarta.Status='I';
							fseek(PtrExCarta, PosCarta, 0);
							fwrite(&ExCarta, sizeof(Cartas), 1, PtrExCarta);
							Carregando();
							gotoxy(33,15);
							printf("CARTA EXCLUIDA!");
						}
					}
					else
					{
						gotoxy(25,15);
						printf("Esta carta esta vinculada a um deck, nao eh possivel exclui-la!");
					}
				}
				else
				{
					if(VerificaCarta(PtrExCarta, ExJogo.CodJogo, PosCarta) == 1)
					{
						gotoxy(33,15);
						printf("Carta Inexistente!");
					}
					else
					{
						gotoxy(27,15);
						printf("Esta Carta pertence a outro jogo!");
					}
				}
					
			}			
			else
			{			
				gotoxy(33,15);
				printf("Carta Inexistente!");
			}
		}
		else 
		{
			gotoxy(33,15);
			printf("Jogo Inexistente!");
		}
		printf("Digite o codigo do jogo:\n");
		scanf("%d",&ExJogo.CodJogo);
	}	
	fclose(PtrExJogo);
	fclose(PtrExCarta);
}



void ExclusaoLogicaDeckCarta(char DeckCarta[100])
{
	int Vet[TF], i=0, TL=0, Pos=0;
	system("cls");
	FILE *PtrExDC = fopen(DeckCarta, "rb+");
	ControlDeckCarta ExCtrlDC;
	MenuConio(0);
	gotoxy(20,3);
	printf("####EXCLUSAO DE RELACAO DE CARTA E DECK####");
	gotoxy(26,5);
	printf("Digite o codigo do Deck: ");
	scanf("%d", &ExCtrlDC.CodDeck);
	while(ExCtrlDC.CodDeck != -1)
	{
		if(ExCtrlDC.CodDeck == 0)
		{
			system("cls");
			gotoxy(27,15);
			printf("O codigo do deck deve ser maior que zero!");
			getch();	
		}
		else
		{
			if(BuscaDC(PtrExDC, ExCtrlDC.CodDeck, Vet, TL) == 1)
			{
				gotoxy(26,7);
				printf("Relacoes que serao excluidas");
				while(i<TL)
				{			
					Pos = Vet[i];
					fseek(PtrExDC, Pos, 0);
					fread(&ExCtrlDC, sizeof(ControlDeckCarta), 1, PtrExDC);
					gotoxy(26,9);
					printf("Codigo do deck: %d", ExCtrlDC.CodDeck);
					gotoxy(26,10);
					printf("Codigo da carta: %d", ExCtrlDC.CodCarta);
					i++;
				}
				i=0;
				gotoxy(26,12);
				printf("Deseja excluir essas relacoes? - (S/N): ");
				if(toupper(getch()) == 'S')
				{
					while(i<TL)
					{	
						fseek(PtrExDC, Pos, 0);
						fread(&ExCtrlDC, sizeof(ControlDeckCarta), 1, PtrExDC);
											
						Pos = Vet[i];						
						ExCtrlDC.Status = 'I';
						fseek(PtrExDC, Pos, 0);
						fwrite(&ExCtrlDC, sizeof(ControlDeckCarta), 1, PtrExDC);						
						i++;
					}
					Carregando();
					gotoxy(33,15);
					printf("RELACAO EXCLUIDA!");					
				}
			}
			else
			{
				gotoxy(27,17);
				printf("Relacoes Inexistentes!");
			}
		}
		getch();
		system("cls");
		MenuConio(0);
		gotoxy(20,3);
		printf("####EXCLUSAO DE RELACAO DE CARTA E DECK####");	
		gotoxy(26,5);
		printf("Digite o codigo do Deck: ");
		scanf("%d", &ExCtrlDC.CodDeck);
	}
	fclose(PtrExDC);
}

void ExcFisicaJogo(char Jogo[100])
{
	FILE *PtrExFisicJogo = fopen(Jogo, "rb");
	FILE *PtrExTemp = fopen("Temp.dat", "wb");	
	
	Jogos ExcFisicJogo;	
	fread(&ExcFisicJogo, sizeof(Jogos), 1, PtrExFisicJogo);
	while(!feof(PtrExFisicJogo))
	{
		if(ExcFisicJogo.Status != 'I')				
			fwrite(&ExcFisicJogo, sizeof(Jogos), 1, PtrExTemp);		
		
		fread(&ExcFisicJogo, sizeof(Jogos), 1, PtrExFisicJogo);	
	}
	fclose(PtrExFisicJogo);
	fclose(PtrExTemp);
	remove(Jogo);
	rename("Temp.dat", Jogo);	
}


void ExcFisicaCarta(char Carta[100])
{
	FILE *PtrExFisicCarta = fopen(Carta, "rb");
	FILE *PtrExTemp = fopen("Temp.dat", "wb");
	
	Cartas ExcFisicCarta;
	
	fread(&ExcFisicCarta, sizeof(Cartas), 1, PtrExFisicCarta);
	while(!feof(PtrExFisicCarta))
	{
		if(ExcFisicCarta.Status != 'I')
			fwrite(&ExcFisicCarta, sizeof(Cartas), 1, PtrExTemp);
		
		fread(&ExcFisicCarta, sizeof(Cartas), 1, PtrExFisicCarta);
	}
	fclose(PtrExFisicCarta);
	fclose(PtrExTemp);
	remove(Carta);
	rename("Temp.dat", Carta);
}

void ExcFisicaDeckCarta(char DeckCarta[100])
{
	FILE *PtrExFisicDC = fopen(DeckCarta, "rb");
	FILE *PtrExTemp = fopen("Temp.dat", "wb");
	
	ControlDeckCarta ExcDC;
	
	fread(&ExcDC, sizeof(ControlDeckCarta), 1, PtrExFisicDC);
	while(!feof(PtrExFisicDC))
	{
		if(ExcDC.Status != 'I')
			fwrite(&ExcDC, sizeof(ControlDeckCarta), 1, PtrExTemp);
		
		fread(&ExcDC, sizeof(ControlDeckCarta), 1, PtrExFisicDC);
	}
	fclose(PtrExFisicDC);
	fclose(PtrExTemp);
	remove(DeckCarta);
	rename("Temp.dat", DeckCarta);
}
 
void AlteraJogos(char Jogo[100], char Deck[100])
{
	system("cls");
	int Pos;
	FILE *PtrAltJogo = fopen(Jogo, "rb+");
	FILE *PtrAltDeck = fopen(Deck, "rb+");
	Jogos AltJogo;
	MenuConio(0);
	gotoxy(26,3);
	printf("#### ALTERACOES DE JOGOS ####");
	gotoxy(27,5);
	printf("Digite o nome do jogo: ");
	scanf("%d", &AltJogo.CodJogo);
	while(AltJogo.CodJogo != -1)
	{
		if(AltJogo.CodJogo == 0)
		{
			system("cls");		
			gotoxy(27,15);
			printf("O codigo do jogo deve ser maior que zero!");
			getch();
		}
		else
		{
			if(BuscaSequencialIndexadaJogo(PtrAltJogo, AltJogo.CodJogo) != -1)
			{
				Pos = BuscaSequencialIndexadaJogo(PtrAltJogo, AltJogo.CodJogo);
				fseek(PtrAltJogo, Pos, 0);
				fread(&AltJogo, sizeof(Jogos), 1, PtrAltJogo);
				gotoxy(27,7);
				printf("Nome do jogo: %s", AltJogo.DescJogo);
				gotoxy(27,9);
				printf("Deseja alterar esse jogo? - (S/N)\n");
				if(toupper(getch()) == 'S')
				{
					gotoxy(27,11);
					printf("Digite o novo nome do jogo: ");
					fflush(stdin);
					gets(AltJogo.DescJogo);
					AlteraDeckEmJogo(PtrAltDeck, AltJogo.CodJogo, AltJogo.DescJogo);
					fseek(PtrAltJogo, Pos, 0);
					fwrite(&AltJogo, sizeof(Jogos), 1, PtrAltJogo);					
					Carregando();
					gotoxy(33,15);
					printf("JOGO ALTERADO!");
					getch();
				}
				
			}
			else
			{
				system("cls");
				gotoxy(33,15);
				printf("Jogo Inexistente!");
				getch();
			}
			
		}
		system("cls");
		MenuConio(0);
		gotoxy(26,3);
		printf("#### ALTERACOES DE JOGOS ####");
		gotoxy(27,5);
		printf("Digite o nome do jogo: ");
		scanf("%d", &AltJogo.CodJogo);
		
	}
	fclose(PtrAltJogo);
	fclose(PtrAltDeck);
}
void AlteraCartas(char Carta[100])
{
	system("cls");
	FILE *PtrAltCarta = fopen(Carta, "rb+");
	Cartas AltCarta;
	int Pos;
	MenuConio(0);
	gotoxy(26,3);
	printf("#### ALTERACOES DE CARTAS ####");
	gotoxy(27,5);
	printf("Digite o codigo da carta: ");
	scanf("%d", &AltCarta.CodCarta);
	while(AltCarta.CodCarta != -1)
	{
		if(AltCarta.CodCarta == 0)
		{
			system("cls");
			gotoxy(27,15);
			printf("O codigo da carta deve ser maior que zero!");
			getch();	
		}		
		else
		{
			if(BuscaBinariaCarta(PtrAltCarta, AltCarta.CodCarta) != -1)
			{
				Pos = BuscaBinariaCarta(PtrAltCarta, AltCarta.CodCarta);
				fseek(PtrAltCarta, Pos, 0);
				fread(&AltCarta, sizeof(Cartas), 1, PtrAltCarta);
				gotoxy(27,7);
				printf("Nome da carta: %s", AltCarta.NomeCarta);
				gotoxy(27,8);
				printf("Descricao: %s", AltCarta.DescCarta);
				gotoxy(27,10);
				printf("Deseja alterar essa carta? - (S/N)");
				if(toupper(getch()) == 'S')
				{
					gotoxy(27,12);
					printf("Digite o novo nome da carta: ");
					fflush(stdin);
					gets(AltCarta.NomeCarta);
					gotoxy(27,13);
					printf("Digite a nova descricao da carta: ");
					fflush(stdin);
					gets(AltCarta.DescCarta);					
					fseek(PtrAltCarta, Pos, 0);
					fwrite(&AltCarta, sizeof(Cartas), 1, PtrAltCarta);
					Carregando();
					gotoxy(33,15);
					printf("CARTA ALTERADA!");
					getch();					
				}
				
				
				
			}
			else
			{	
				system("cls");
				gotoxy(33,15);
				printf("Carta Inexistente!");	
				getch();
			}
			
		}
		system("cls");
		MenuConio(0);
		gotoxy(26,3);
		printf("#### ALTERACOES DE CARTAS ####");
		gotoxy(27,5);
		printf("Digite o codigo da carta: ");
		scanf("%d", &AltCarta.CodCarta);	
	}
	fclose(PtrAltCarta);	
}

void AlteraDecks(char Deck[100])
{	
	FILE *PtrAltDeck = fopen(Deck, "rb+");
	Decks AltDeck;
	int Pos;
	system("cls");
	MenuConio(0);
	gotoxy(26,3);
	printf("#### ALTERACOES DE DECKS ####");
	gotoxy(27,5);
	printf("Digite o codigo do deck: ");
	scanf("%d", &AltDeck.CodDeck);
	while(AltDeck.CodDeck != -1)
	{
		if(AltDeck.CodDeck == 0)
		{
			system("cls");
			gotoxy(27,15);
			printf("O codigo do deck deve ser maior que zero!");
			getch();
		}
		else
		{
			if(BuscaSentinelaDeck(PtrAltDeck, AltDeck.CodDeck) != -1)
			{
				Pos = BuscaSentinelaDeck(PtrAltDeck, AltDeck.CodDeck);
				fseek(PtrAltDeck, Pos, 0);
				fread(&AltDeck, sizeof(Decks), 1, PtrAltDeck);
				gotoxy(27,7);
				printf("Nome do deck: %s", AltDeck.Titulo);
				gotoxy(27,8);
				printf("Jogador responsavel: %s", AltDeck.Jogador);
				gotoxy(27,9);
				printf("Ano de criacao: %d", AltDeck.Ano);
				gotoxy(27,11);
				printf("Deseja alterar esse deck? - (S/N)");
				if(toupper(getch()) == 'S')
				{
					gotoxy(27,13);
					printf("Digite o novo nome do deck: ");
					fflush(stdin);
					gets(AltDeck.Titulo);
					gotoxy(27,14);
					printf("Digite o novo jogador resposnavel do deck: ");
					fflush(stdin);
					gets(AltDeck.Jogador);
					gotoxy(27,15);
					printf("Digite o novo ano de criacao do deck: ");
					fflush(stdin);
					scanf("%d", &AltDeck.Ano);
					fseek(PtrAltDeck, Pos, 0);
					fwrite(&AltDeck, sizeof(Decks), 1, PtrAltDeck);
					Carregando();
					gotoxy(33,15);
					printf("DECK ALTERADO!");
					getch();		
				}			
			}
			else
			{	
				system("cls");
				gotoxy(33,15);
				printf("Deck Inexistente!");			
				getch();
			}
		}
		system("cls");
		MenuConio(0);
		gotoxy(26,3);
		printf("#### ALTERACOES DE DECKS ####");
		gotoxy(27,5);
		printf("Digite o codigo do deck: ");
		scanf("%d", &AltDeck.CodDeck);
	}
	fclose(PtrAltDeck);
}

void PesquisaCodJogo(char Jogo[100])
{	
	FILE *PtrPesqJogo = fopen(Jogo, "rb");
	int Pos;
	Jogos PesqJogo;
	system("cls");
	MenuConio(0);
	gotoxy(26,3);
	printf("#### PESQUISA DE JOGOS ####");
	gotoxy(27,5);
	printf("Digite o codigo do jogo: ");
	scanf("%d", &PesqJogo.CodJogo);
	while(PesqJogo.CodJogo != -1)
	{
		if(PesqJogo.CodJogo == 0)
		{
			system("cls");
			gotoxy(27,15);
			printf("O codigo do jogo deve ser maior que zero!");
			getch();
		}
		else
		{
			if(BuscaSequencialIndexadaJogo(PtrPesqJogo, PesqJogo.CodJogo) != -1)
			{
				Pos = BuscaSequencialIndexadaJogo(PtrPesqJogo, PesqJogo.CodJogo);
				fseek(PtrPesqJogo, Pos, 0);
				fread(&PesqJogo, sizeof(Jogos), 1, PtrPesqJogo);
				gotoxy(27,7);
				printf("Codigo do jogo: %d", PesqJogo.CodJogo);
				gotoxy(27,8);
				printf("Nome do jogo: %s", PesqJogo.DescJogo);
				getch();
			}
			else
			{
				system("cls");
				gotoxy(33,15);
				printf("Jogo Inexistente!");			
				getch();
			}
		}
		system("cls");
		MenuConio(0);
		gotoxy(26,3);
		printf("#### PESQUISA DE JOGOS ####");
		gotoxy(27,5);
		printf("Digite o codigo do jogo: ");
		scanf("%d", &PesqJogo.CodJogo);
		
	}
	fclose(PtrPesqJogo);
}

void PesquisaCodCarta(char Carta[100])
{	
	FILE *PtrPesqCarta = fopen(Carta, "rb");
	Cartas PesqCarta;
	int Pos;
	system("cls");
	MenuConio(0);
	gotoxy(26,3);
	printf("#### PESQUISA DE CARTAS ####");
	gotoxy(27,5);
	printf("Digite o codigo da carta: ");
	scanf("%d", &PesqCarta.CodCarta);
	while(PesqCarta.CodCarta != -1)
	{
		if(PesqCarta.CodCarta == 0)
		{
			system("cls");
			gotoxy(27,15);
			printf("O codigo da carta deve ser maior que zero!");
			getch();
		}
		else
		{
			if(BuscaBinariaCarta(PtrPesqCarta, PesqCarta.CodCarta) != -1)
			{
				Pos = BuscaBinariaCarta(PtrPesqCarta, PesqCarta.CodCarta);
				
				fseek(PtrPesqCarta, Pos, 0);
				fread(&PesqCarta, sizeof(Cartas), 1, PtrPesqCarta);
				gotoxy(27,7);
				printf("Codigo da carta: %d", PesqCarta.CodCarta);
				gotoxy(27,8);
				printf("Nome da carta: %s", PesqCarta.NomeCarta);
				gotoxy(27,9);
				printf("Descricao da carta: %s", PesqCarta.DescCarta);
				
				getch();
			}		
		}
		system("cls");
		MenuConio(0);
		gotoxy(26,3);
		printf("#### PESQUISA DE CARTAS ####");
		gotoxy(27,5);
		printf("Digite o codigo da carta: ");
		scanf("%d", &PesqCarta.CodCarta);		
	}	
	fclose(PtrPesqCarta);	
}

void PesquisaCodDeck(char Deck[100])
{	
	FILE *PtrPesqDeck = fopen(Deck, "rb+");
	Decks PesqDeck;
	int Pos;
	system("cls");
	MenuConio(0);
	gotoxy(26,3);
	printf("#### PESQUISA DE DECKS ####");
	gotoxy(27,5);
	printf("Digite o codigo do deck: ");
	scanf("%d", &PesqDeck.CodDeck);
	while(PesqDeck.CodDeck != -1)
	{
		if(PesqDeck.CodDeck == 0)
		{
			system("cls");
			gotoxy(27,15);
			printf("O codigo do deck deve ser maior que zero!");
			getch();
		}
		else
		{
			if(BuscaSentinelaDeck(PtrPesqDeck, PesqDeck.CodDeck) != -1)
			{
				Pos = BuscaSentinelaDeck(PtrPesqDeck, PesqDeck.CodDeck);
				
				fseek(PtrPesqDeck, Pos, 0);
				fread(&PesqDeck, sizeof(Decks), 1, PtrPesqDeck);
				gotoxy(27,7);
				printf("Codigo do deck: %d", PesqDeck.CodDeck);
				gotoxy(27,8);
				printf("Nome do deck: %s", PesqDeck.Titulo);
				gotoxy(27,9);
				printf("Jogo vinculado ao deck: %s", PesqDeck.NomeJogo);
				gotoxy(27,10);
				printf("Jogador Responsavel: %s", PesqDeck.Jogador);
				gotoxy(27,11);
				printf("Ano de criacao: %d", PesqDeck.Ano);
				getch();			
			}	
		}
		system("cls");
		MenuConio(0);
		gotoxy(26,3);
		printf("#### PESQUISA DE DECKS ####");
		gotoxy(27,5);
		printf("Digite o codigo do deck: ");
		scanf("%d", &PesqDeck.CodDeck);
	}
	fclose(PtrPesqDeck);
}

void PesquisaCodDC(char DeckCarta[100])
{	
	FILE *PtrPesqDC = fopen(DeckCarta, "rb");
	ControlDeckCarta PesqDC;
	int Pos, i=0, TL=0, Vet[TF];
	system("cls");
	MenuConio(0);
	gotoxy(20,3);
	printf("#### PESQUISA DE RELACAO DECK E CARTA ####");
	gotoxy(25,5);
	printf("Digite o codigo do deck: ");
	scanf("%d", &PesqDC.CodDeck);
	while(PesqDC.CodDeck != -1)
	{
		if(PesqDC.CodDeck == 0)
		{	
			system("cls");
			gotoxy(27,15);
			printf("O codigo do deck deve ser maior que zero!");
			getch();
		}
		else
		{
			if(BuscaDC(PtrPesqDC, PesqDC.CodDeck, Vet, TL) != -1 && i < TL)
			{										
				gotoxy(25,7);								
				printf("Relacoes deste deck");
				while(i<TL)
				{			
					Pos = Vet[i];
					fseek(PtrPesqDC, Pos, 0);
					fread(&PesqDC, sizeof(ControlDeckCarta), 1, PtrPesqDC);
					gotoxy(25,9);
					printf("Codigo do deck: %d", PesqDC.CodDeck);
					gotoxy(25,10);
					printf("Codigo da carta: %d", PesqDC.CodCarta);
					i++;
				}
				getch();
				TL=0;
				i=0;							
			}
			else
			{
				system("cls");
				gotoxy(33,15);
				printf("Deck Nao tem relacoes!");			
				getch();
			}
		}
		system("cls");
		MenuConio(0);
		gotoxy(20,3);
		printf("#### PESQUISA DE RELACAO DECK E CARTA ####");
		gotoxy(25,5);
		printf("Digite o codigo do deck: ");
		scanf("%d", &PesqDC.CodDeck);		
	}
	fclose(PtrPesqDC);
}

void PesquisaNomeJogo(char Jogo[100])
{	
	FILE *PtrNomeJogo = fopen(Jogo, "rb");
	Jogos PesqJogo;
	char Desc[300];
	int Pos;
	system("cls");
	MenuConio(0);
	gotoxy(25,3);
	printf("#### PESQUISA DE JOGOS ####");
	gotoxy(27,5);
	printf("Digite o nome do jogo: ");
	fflush(stdin);
	gets(Desc);
	while(strcmp(Desc, "\0") != 0)
	{
		rewind(PtrNomeJogo);
		fread(&PesqJogo, sizeof(Jogos), 1, PtrNomeJogo);
		while(!feof(PtrNomeJogo))
		{
			if(stricmp(Desc, PesqJogo.DescJogo) == 0)
			{
				gotoxy(27,7);
				printf("Codigo do jogo: %d", PesqJogo.CodJogo);
				gotoxy(27,8);
				printf("Nome do jogo: %s", PesqJogo.DescJogo);
			}
			fread(&PesqJogo, sizeof(Jogos), 1, PtrNomeJogo);
		}
		getch();
		system("cls");
		MenuConio(0);
		gotoxy(25,3);
		printf("#### PESQUISA DE JOGOS ####");
		gotoxy(27,5);
		printf("Digite o nome do jogo: ");
		fflush(stdin);
		gets(Desc);
		
	}
	fclose(PtrNomeJogo);
}

void PesquisaNomeCarta(char Carta[100])
{
	system("cls");
	FILE *PtrNomeCarta = fopen(Carta, "rb");
	Cartas PesqCarta;
	char Desc[100];
	MenuConio(0);
	gotoxy(25,3);
	printf("#### PESQUISA DE CARTAS ####");
	gotoxy(27,5);
	printf("Digite o nome da carta: ");
	fflush(stdin);
	gets(Desc);
	while(strcmp(Desc, "\0") != 0)
	{
		fread(&PesqCarta, sizeof(Cartas), 1, PtrNomeCarta);
		while(!feof(PtrNomeCarta))
		{
			if(stricmp(Desc, PesqCarta.NomeCarta) == 0)
			{	
				gotoxy(27,7);		
				printf("Codigo da carta: %d", PesqCarta.CodCarta);
				gotoxy(27,8);
				printf("Nome da carta: %s",PesqCarta.NomeCarta);
				gotoxy(27,9);
				printf("Descricao da carta: %s", PesqCarta.DescCarta);
			}
			fread(&PesqCarta, sizeof(Cartas), 1, PtrNomeCarta);		
		}
		getch();
		system("cls");
		MenuConio(0);
		gotoxy(25,3);
		printf("#### PESQUISA DE CARTAS ####");
		gotoxy(27,5);
		printf("Digite o nome da carta: ");
		fflush(stdin);
		gets(Desc);		
	}
	fclose(PtrNomeCarta);
}

void PesquisaNomeDeck(char Deck[100])
{	
	FILE *PtrNomeDeck = fopen(Deck, "rb+");
	Decks PesqDeck;
	char Desc[300];
	system("cls");
	MenuConio(0);
	gotoxy(25,3);
	printf("#### PESQUISA DE DECKS ####");
	gotoxy(27,5);
	printf("Digite o nome do deck: ");
	fflush(stdin);
	gets(Desc);
	while(strcmp(Desc, "\0") != 0)
	{
		fread(&PesqDeck, sizeof(Decks), 1, PtrNomeDeck);
		while(!feof(PtrNomeDeck))
		{	
			if(stricmp(Desc, PesqDeck.Titulo) == 0)
			{
				gotoxy(27,7);
				printf("Codigo do deck: %d", PesqDeck.CodDeck);
				gotoxy(27,8);
				printf("Nome do deck: %s", PesqDeck.Titulo);
				gotoxy(27,9);
				printf("Jogador Responsavel: %s", PesqDeck.Jogador);
				gotoxy(27,10);
				printf("Jogo que o deck pertence: %s", PesqDeck.NomeJogo);
				gotoxy(27,11);
				printf("Ano de criacao: %d", PesqDeck.Ano);
	
			}
			fread(&PesqDeck, sizeof(Decks), 1, PtrNomeDeck);	
		}
		getch();
		system("cls");
		MenuConio(0);
		gotoxy(25,3);
		printf("#### PESQUISA DE DECKS ####");
		gotoxy(27,5);
		printf("Digite o nome do deck: ");
		fflush(stdin);
		gets(Desc);	
	}	
	fclose(PtrNomeDeck);	
}


char Menu(int &i)
{		
	system("cls");
	if(i==0)
	{		
		MenuConio(15);
		i=1;
	}
	else
		MenuConio(0);	
	gotoxy(33, 4);
	printf("%c%c MENU %c%c\n", 175, 175, 174, 174);
	gotoxy(30,6);
	printf("[A] - CADASTRAR");
	gotoxy(30,8);
	printf("[B] - EXIBIR");
	gotoxy(30,10);	
	printf("[C] - ALTERAR");
	gotoxy(30,12);
	printf("[D] - EXCLUIR");
	gotoxy(30,14);
	printf("[E] - PESQUISAR PELO CODIGO");
	gotoxy(30,16);
	printf("[F] - PESQUISAR PELO NOME");
	gotoxy(30,18);
	printf("[ESC] - SAIR");
	gotoxy(30,20);
	printf("O que deseja fazer? ");	
	return toupper(getche());
}

char MenuCadastro()
{
	fflush(stdin);	
	system("cls");
	MenuConio(0);
	gotoxy(29, 4);
	printf("%c%c Menu de Cadastro %c%c\n", 175, 175, 174, 174);
	gotoxy(31, 6);
	printf("[A] - Jogo(s)");
	gotoxy(31, 8);
	printf("[B] - Carta(s)");
	gotoxy(31, 10);
	printf("[C] - Decks(s)");
	gotoxy(31, 12);
	printf("[D] - Carta(s) em Deck(s)");
	gotoxy(31, 14);
	printf("O que deseja cadastrar? ");
	return toupper(getche());
}

char MenuExibe()
{
	system("cls");
	MenuConio(0);
	gotoxy(26, 4);
	printf("%c%c Menu de Exibicao %c%c\n", 175, 175, 174, 174);
	gotoxy(29,6);
	printf("[A] - Jogo(s)");
	gotoxy(29,8);
	printf("[B] - Carta(s)");
	gotoxy(29,10);
	printf("[C] - Deck(s)");	
	gotoxy(29,12);
	printf("[D] - Relatorio(s) de Deck(s)");
	gotoxy(29,14);
	printf("O que deseja exibir? ");
	return toupper(getche());
}

char MenuExclusao()
{
	system("cls");
	MenuConio(0);
	gotoxy(26, 4);
	printf("%c%c Menu de Exclusao %c%c", 175, 175, 174, 174);
	gotoxy(29, 6);
	printf("[A] - Jogo(s)");
	gotoxy(29, 8);
	printf("[B] - Carta(s)");
	gotoxy(29, 10);
	printf("[C] - Deck(s)");
	gotoxy(29, 12);
	printf("[D] - Relacao de Deck e Carta");
	gotoxy(29, 14);
	printf("O que deseja excluir? ");
	return toupper(getche());
}

char MenuAltera()
{
	system("cls");
	MenuConio(0);
	gotoxy(26, 4);
	printf("%c%c Menu de Alteracao %c%c", 175, 175, 174, 174);
	gotoxy(29, 6);
	printf("[A] - Jogo(s)");
	gotoxy(29, 8);
	printf("[B] - Carta(s)");
	gotoxy(29, 10);
	printf("[C] - Deck(s)");	
	gotoxy(29, 12);
	printf("Oque deseja alterar? ");
	return toupper(getche());	
}

char MenuPesquisaCod()
{
	system("cls");
	MenuConio(0);
	gotoxy(26, 4);
	printf("%c%c Menu de Pesquisa %c%c", 175, 175, 174, 174);
	gotoxy(29, 6);
	printf("[A] - Jogo(s)");
	gotoxy(29, 8);
	printf("[B] - Carta(s)");
	gotoxy(29, 10);
	printf("[C] - Deck(s)");
	gotoxy(29, 12);
	printf("[D] - Relacao(oes) de deck(s) e carta(s)");
	gotoxy(29, 14);
	printf("O que deseja pesquisar? ");
	return toupper(getche());
}

char MenuPesquisaNome()
{
	system("cls");
	MenuConio(0);
	gotoxy(26, 4);
	printf("%c%c Menu de Pesquisa %c%c", 175, 175, 174, 174);
	gotoxy(29, 6);
	printf("[A] - Jogo(s)");
	gotoxy(29, 8);
	printf("[B] - Carta(s)");
	gotoxy(29, 10);
	printf("[C] - Deck(s)");
	gotoxy(29, 12);	
	printf("O que deseja pesquisar? ");
	return toupper(getche());
}
void MenuConio(int z)
{
	system("cls");
	textbackground(BLACK);
	int x=5, y=2;
	for(int i=0; i<20; i++)
	{
		gotoxy(x,y);
		printf("%c", 220);		
		y++;
		Sleep(z);
	}
	for(int i=0; i<35;i++)
	{
		gotoxy(x,y);
		printf("%c", 220);
		x = x+2;
		Sleep(z);
	}
	for(int i=0;i<21;i++)	
	{
		gotoxy(x,y);
		printf("%c", 220);
		y = y-1;
		Sleep(z);
	}
	y=1;
	x=75;
	for(int i=36;i>0;i--)
	{		
		gotoxy(x,y);
		printf("%c", 220);
		x = x - 2;
		Sleep(z);	
	}		
	
}

void Inicio()
{
	system("cls");		
	Sleep(90);
	gotoxy(30,6);
	printf("%c%c", 175, 175);
	gotoxy(32,6);
	printf(" CONTROLE DE DECKS DE CARTAS ");
	gotoxy(61,6);
	printf("%c%c",174,174);
	gotoxy(30,10);
	printf("%c%c", 175, 175);
	gotoxy(42,10);
	printf(" Autores ");
	gotoxy(61,10);
	printf("%c%c",174,174);
	gotoxy(30,14);
	printf("%c%c", 175, 175);
	gotoxy(35,14);
	printf(" VINICIUS SOUZA MARTINS  ");	
	gotoxy(61,14);
	printf("%c%c",174,174);	
	gotoxy(75,11);
	for(int i=0; i<10; i++)
	{		
		Sleep(200);
    	printf(" ");				
	}
}

void Executar(void)
{	
	char opM, opC, opE,opA,opEx,opP, opPC;
	int i=0;	
	Inicio();
	do
	{		
		opM = Menu(i);		
		switch(opM)
		{
			case 'A': opC = MenuCadastro();
					  switch(opC)
					  {
					  		case 'A': CadastroJogos("Jogos.dat");
					  				  break;
					  		case 'B': CadastroCartas("Cartas.dat", "Jogos.dat");
					  				  break;
					  		case 'C': CadastroDecks("Decks.dat", "Jogos.dat");
					  				  break;
					  		case 'D': CadastroCartaInDeck("Jogos.dat", "Decks.dat", "Cartas.dat", "DecksECartas.dat");
					  				  break;
					  		case 0:	  break;
					  		default:					  			
					  			gotoxy(35,16);
					  			printf("Opcao Invalida!");
					  			Sleep(1000);
					  		fflush(stdin);
					  }
					  break;
			case 'B': opE = MenuExibe();
					  switch(opE)
					  {
					  	case 'A': ExibirJogos("Jogos.dat");
					  			  break;
					  	case 'B': ExibirCartas("Cartas.dat");	
					  			  break;
					  	case 'C': ExibirDecks("Decks.dat");
					  			  break;					  
					  	case 'D': RelatorioDecks("Decks.dat", "DecksECartas.dat", "Cartas.dat");
					  			  break;	  
						default:
							gotoxy(35,20);
							printf("Opcao Invalida!");
							Sleep(1000);
					  }
					  break;
			case 'C': opA = MenuAltera();
					  switch(opA)
					  {
					  	case 'A': AlteraJogos("Jogos.dat", "Decks.dat");
					  			  break;
					  	case 'B': AlteraCartas("Cartas.dat");
								  break;
						case 'C': AlteraDecks("Decks.dat");
								  break;						
						default:
							gotoxy(35,16);
							printf("Opcao Invalida!");
							Sleep(1000);				
					  }
					  break;					  
			case 'D': opEx = MenuExclusao();
					  switch(opEx)
					  {
					  	case 'A': ExclusaoLogicaJogos("Jogos.dat", "Cartas.dat", "Decks.dat", "DecksECartas.dat");
					  			  break;
					  	case 'B': ExclusaoLogicaCartas("Jogos.dat", "Cartas.dat", "DecksECartas.dat");
					  			  break;
					  	case 'C': ExclusaoLogicaDecks("Jogos.dat", "DecksECartas.dat", "Decks.dat");
					  			  break;
					  	case 'D': ExclusaoLogicaDeckCarta("DecksECartas.dat");
					  			  break;
					  	default:
					  		gotoxy(33,18);
					  		printf("Opcao Invalida!");
					  		Sleep(1000);
					  }
					  break;
			case 'E': opP = MenuPesquisaCod();
					  switch(opP)
					  {
					  	case 'A': PesquisaCodJogo("Jogos.dat");
					  			  break;
						case 'B': PesquisaCodCarta("Cartas.dat");
								  break;
						case 'C': PesquisaCodDeck("Decks.dat");
								  break;
						case 'D': PesquisaCodDC("DecksECartas.dat");
								  break;
						default:
							gotoxy(33,18);
							printf("Opcao Invalida!");
							Sleep(1000);
					  }						
					  break;
		
		
			case 'F': opPC = MenuPesquisaNome();
					  switch(opPC)
					  {
					  	case 'A': PesquisaNomeJogo("Jogos.dat");
					  			  break;
						case 'B': PesquisaNomeCarta("Cartas.dat");
								  break;
						case 'C': PesquisaNomeDeck("Decks.dat");
								  break;						
						default:
							gotoxy(33,16);
							printf("Opcao Invalida!");
							Sleep(1000);					  	
					  }
					  break;
		}
	}while(opM!=27);
}

int main()
{	
	FILE *PtrJogo = fopen("Jogos.dat","rb");
	FILE *PtrCarta = fopen("Cartas.dat","rb");
	FILE *PtrDeck = fopen("Decks.dat","rb");
	FILE *PtrControlDC = fopen("DecksECartas.dat","rb");	

	if(PtrJogo ==  NULL)
	{		
		PtrJogo = fopen("Jogos.dat","wb");
		CadastroAutomaticoJogo("Jogos.dat");
	}
	if(PtrCarta ==  NULL)	
	{
		PtrJogo = fopen("Cartas.dat","wb");
		CadastroAutomaticoCarta("Cartas.dat");
	}
	if(PtrDeck ==  NULL)
	{			
		PtrJogo = fopen("Decks.dat","wb");			
		CadastroAutomaticoDeck("Decks.dat");
	}
	if(PtrControlDC == NULL)
	{
		PtrControlDC = fopen("DecksECartas.dat", "wb");
		CadastroAutomaticoDeckCarta("DecksECartas.dat");	
	}
	fclose(PtrDeck);
	fclose(PtrCarta);
	fclose(PtrJogo);
	fclose(PtrControlDC);
		
	Executar();
	
	system("cls");
	MenuConio(0);
	gotoxy(28,5);	
	printf("Finalizando programa...");	
	ExcFisicaJogo("Jogos.dat");	
	ExcFisicaDeck("Decks.dat");
	ExcFisicaCarta("Cartas.dat");
	ExcFisicaDeckCarta("DecksECartas.dat");	
	Sleep(1500);
	clrscr();
	return 1;	
}
